import{e as g,o as s,c as l,t as m,r as v,g as w,w as T,h as t,z as C,k,a as i,i as p,j as x,x as z,l as I,m as P,A as q}from"./vendor.6a80e32c.js";import{P as D}from"./PrizeHeader.9f017f76.js";import{_ as B,u as A}from"./useError.c494153b.js";import{u as S,_ as y}from"./index.69cff91e.js";const N={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-lightest text-green-darker"},R=g({props:{text:{type:String,required:!0}},setup(e){return(a,n)=>(s(),l("span",N,m(e.text),1))}}),V=k(" Redeem \xA0> "),j=g({props:{prizeId:{type:String,required:!0},disabled:{type:Boolean,default:!1}},emits:["submitted","errored"],setup(e,{emit:a}){let n=S(),d=v(!1);async function r(o){d.value=!0;let u=await fetch(`https://resman-rewards-api.herokuapp.com/api/prizes/${o}/redeem`,{method:"POST",headers:{"X-Access-Token":n.token.value}}),c=await u.json();if(u.status!==200){d.value=!1,a("errored",c.message||"Something went wrong");return}d.value=!1,a("submitted",c.data)}return(o,u)=>(s(),l("form",{class:"py-8",onSubmit:u[0]||(u[0]=C(c=>r(e.prizeId),["prevent"]))},[w(B,{type:"submit",class:"w-auto",loading:t(d),disabled:e.disabled},{default:T(()=>[V]),_:1},8,["loading","disabled"])],32))}}),E={class:"w-full h-full px-8 py-6 bg-white rounded shadow"},O={class:"flex items-center justify-between"},X={class:"py-2.5 text-3xl font-eloquia text-gray-darker"},H={class:"mt-12 border-t border-b border-gray-light"},M={class:"flex items-center"},F={key:0,class:"text-red ml-4"},U={key:0,class:"mt-4"},G={class:"text-sm"},J={class:"font-bold"},K=k(" left in stock "),L=g({props:{prize:{type:Object,required:!0}},emits:["update-prize"],setup(e){let a=A();return(n,d)=>(s(),l("div",E,[i("div",O,[i("h4",X,m(e.prize.name),1),e.prize.redeemed?(s(),p(R,{key:0,text:"Redeemed"})):x("",!0)]),i("div",H,[i("div",M,[w(j,{"prize-id":e.prize._id,disabled:e.prize.redeemed||e.prize.stock===0,onErrored:d[0]||(d[0]=r=>t(a).set(r)),onSubmitted:d[1]||(d[1]=r=>n.$emit("update-prize",r))},null,8,["prize-id","disabled"]),t(a).show?(s(),l("p",F,m(t(a).message.value),1)):x("",!0)])]),e.prize?(s(),l("div",U,[i("p",G,[i("span",J,m(e.prize.stock),1),K])])):x("",!0)]))}}),Q={},W={class:"w-full h-full px-8 py-6 bg-white rounded shadow animate-pulse"},Y=z('<div class="flex items-center justify-between"><div class="w-[250px] h-[25px] rounded-full bg-gray-light"></div><div class="w-[80px] h-[20px] rounded-full bg-gray-light"></div></div><div class="mt-12 border-t border-b border-gray-light"><div class="flex items-center py-8"><div class="w-[140px] h-[40px] rounded-full bg-gray-light"></div></div></div><div class="mt-4"><div class="w-[100px] h-[18px] rounded-sm bg-gray-light"></div></div>',3),Z=[Y];function ee(e,a){return s(),l("div",W,Z)}var te=y(Q,[["render",ee]]);const se={class:"flex flex-col lg:flex-row lg:space-x-16"},re=i("h5",{class:"text-2xl font-eloquia text-center sm:text-left"},"Description",-1),ie={class:"mt-1.5 font-light text-center sm:text-left"},ae=g({props:{value:{type:String,required:!0}},setup(e){return(a,n)=>(s(),l("div",se,[re,i("p",ie,m(e.value),1)]))}}),de={},le={class:"flex flex-col lg:flex-row lg:space-x-16"},oe=z('<div class="flex justify-center"><div class="w-[120px] h-[24px] bg-gray-light rounded animate-pulse"></div></div><div class="flex flex-col items-center sm:items-start space-y-2 sm:ml-20 mt-8 lg:mt-0 animate-pulse"><div class="w-[400px] lg:w-[700px] h-[16px] bg-gray-light rounded"></div><div class="w-[380px] lg:w-[600px] h-[16px] bg-gray-light rounded"></div><div class="w-[400px] lg:w-[700px] h-[16px] bg-gray-light rounded"></div><div class="w-[350px] lg:w-[550px] h-[16px] bg-gray-light rounded"></div><div class="w-[320px] lg:w-[500px] h-[16px] bg-gray-light rounded"></div><div class="w-[370px] lg:w-[600px] h-[16px] bg-gray-light rounded"></div><div class="w-[400px] lg:w-[450px] h-[16px] bg-gray-light rounded"></div><div class="w-[360px] lg:w-[600px] h-[16px] bg-gray-light rounded"></div><div class="w-[340px] lg:w-[550px] h-[16px] bg-gray-light rounded"></div><div class="w-[380px] lg:w-[500px] h-[16px] bg-gray-light rounded"></div><div class="w-[400px] lg:w-[400px] h-[16px] bg-gray-light rounded"></div></div>',2),ne=[oe];function ce(e,a){return s(),l("div",le,ne)}var ue=y(de,[["render",ce]]);const pe={class:"aspect-w-3 aspect-h-4"},ge=["src"],xe=g({props:{source:{type:String,required:!0}},setup(e){return(a,n)=>(s(),l("div",pe,[i("img",{class:"object-cover rounded",src:e.source,alt:"Prize Image"},null,8,ge)]))}}),he={},_e={class:"w-full lg:w-[465px] h-[315px] bg-gray-light animate-pulse rounded"};function me(e,a){return s(),l("div",_e)}var fe=y(he,[["render",me]]),h=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",Card:L,CardSkeleton:te,DescriptionText:ae,DescriptionTextSkeleton:ue,Image:xe,ImageSkeleton:fe,RedeemPrizeFormButton:j});const ve={class:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8"},we={class:"py-12"},ye={class:"grid grid-cols-2 gap-x-8"},be={class:"col-span-2 lg:col-span-1"},$e={class:"col-span-2 lg:col-span-1"},ke={class:"mt-10"},ze={class:"border-t border-gray-light py-12"},Ie=g({setup(e,{expose:a}){let n=I(),d=S(),r=v(null),o=v(!1);async function u(c=n.params.id){if(o.value)return;o.value=!0;let _=await fetch(`https://resman-rewards-api.herokuapp.com/api/prizes/${c}`,{headers:{"X-Access-Token":d.token.value}});if(_.status!==200){o.value=!1;return}let f=await _.json();r.value=f.data,o.value=!1}return P(d.authenticated,c=>{c&&u()}),a({prize:r}),(c,_)=>{var f,b;return s(),l("div",null,[w(D),i("main",ve,[i("div",we,[i("div",ye,[i("div",be,[t(o)?(s(),p(t(h).ImageSkeleton,{key:0})):t(r)?(s(),p(t(h).Image,{key:1,source:(f=t(r))==null?void 0:f.image_url},null,8,["source"])):x("",!0)]),i("div",$e,[t(o)?(s(),p(t(h).CardSkeleton,{key:0})):t(r)?(s(),p(t(h).Card,{key:1,prize:t(r),onUpdatePrize:_[0]||(_[0]=$=>q(r)?r.value=$:r=$)},null,8,["prize"])):x("",!0)])]),i("div",ke,[i("div",ze,[t(o)?(s(),p(t(h).DescriptionTextSkeleton,{key:0})):t(r)?(s(),p(t(h).DescriptionText,{key:1,value:(b=t(r))==null?void 0:b.description},null,8,["value"])):x("",!0)])])])])])}}});export{Ie as default};
