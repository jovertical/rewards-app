import{e as g,r as x,o,c as r,g as f,w as y,h as s,y as v,k,l as w,m as z,a as t,j as c,t as m,z as j}from"./vendor.1ea87c8f.js";import{_ as $,u as S}from"./useError.03f5dd08.js";import{u as b}from"./index.6f2e1b56.js";import{P}from"./PrizeHeader.d4ff2112.js";const A=k(" Redeem \xA0> "),B=g({props:{prizeId:{type:String,required:!0},disabled:{type:Boolean,default:!1}},emits:["submitted","errored"],setup(_,{emit:p}){let h=b(),i=x(!1);async function u(e){i.value=!0;let d=await fetch(`https://resman-rewards-api.herokuapp.com/api/prizes/${e}/redeem`,{method:"POST",headers:{"X-Access-Token":h.token.value}}),a=await d.json();if(d.status!==200){i.value=!1,p("errored",a.message||"Something went wrong");return}i.value=!1,p("submitted",a.data)}return(e,d)=>(o(),r("form",{class:"py-8",onSubmit:d[0]||(d[0]=v(a=>u(_.prizeId),["prevent"]))},[f($,{type:"submit",class:"w-auto",loading:s(i),disabled:_.disabled},{default:y(()=>[A]),_:1},8,["loading","disabled"])],32))}}),E={class:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8"},N={class:"py-12"},R={class:"grid grid-cols-2 gap-x-8"},T={key:0,class:"col-span-2 lg:col-span-1"},V={class:"aspect-w-3 aspect-h-4"},q=["src"],C={key:1,class:"col-span-2 lg:col-span-1 h-full px-8 py-6 bg-white rounded shadow"},D={class:"flex items-center justify-between"},H={class:"py-2.5 text-3xl font-eloquia text-gray-darker"},I={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-lightest text-green-darker"},X={class:"mt-12 border-t border-b border-gray-light"},M={class:"flex items-center"},O={key:0,class:"text-red ml-4"},F={key:0,class:"mt-4"},G={class:"text-sm"},J={class:"mt-10"},K={class:"border-t border-gray-light py-12"},L={key:0,class:"flex"},Q=t("h5",{class:"text-2xl font-eloquia"},"Description",-1),U={class:"ml-20 mt-1.5 font-light"},se=g({setup(_,{expose:p}){let h=w(),i=b(),u=S(),e=x(null);async function d(a=h.params.id){let n=await fetch(`https://resman-rewards-api.herokuapp.com/api/prizes/${a}`,{headers:{"X-Access-Token":i.token.value}});if(n.status!==200)return;let l=await n.json();e.value=l.data}return z(i.authenticated,a=>{a&&d()}),p({prize:e}),(a,n)=>(o(),r("div",null,[f(P),t("main",E,[t("div",N,[t("div",R,[s(e)?(o(),r("div",T,[t("div",V,[t("img",{class:"object-cover rounded",src:s(e).image_url,alt:""},null,8,q)])])):c("",!0),s(e)?(o(),r("div",C,[t("div",D,[t("h4",H,m(s(e).name),1),s(e).redeemed?(o(),r("span",I," Redeemed ")):c("",!0)]),t("div",X,[t("div",M,[f(B,{"prize-id":s(e)._id,disabled:s(e).redeemed||s(e).stock===0,onErrored:n[0]||(n[0]=l=>s(u).set(l)),onSubmitted:n[1]||(n[1]=l=>j(e)?e.value=l:e=l)},null,8,["prize-id","disabled"]),s(u).show?(o(),r("p",O,m(s(u).message.value),1)):c("",!0)])]),s(e)?(o(),r("div",F,[t("span",G,m(s(e).stock)+" left in stock",1)])):c("",!0)])):c("",!0)]),t("div",J,[t("div",K,[s(e)?(o(),r("div",L,[Q,t("p",U,m(s(e).description),1)])):c("",!0)])])])])]))}});export{se as default};
